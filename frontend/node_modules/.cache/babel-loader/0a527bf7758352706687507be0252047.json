{"ast":null,"code":"import _regeneratorRuntime from\"/home/ubuntu/Quantitative_Analysis_Site/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/ubuntu/Quantitative_Analysis_Site/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/ubuntu/Quantitative_Analysis_Site/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,Component}from\"react\";import'./console.css';import*as constants from'../constants.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Console(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),allBranches=_useState2[0],setAllBranches=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),pastEvents=_useState6[0],setPastEvents=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),formBranch=_useState8[0],setFormBranch=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),formAlg=_useState10[0],setFormAlg=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),formTickers=_useState12[0],setFormTickers=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),formStartDate=_useState14[0],setFormStartDate=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),formEndDate=_useState16[0],setFormEndDate=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),experimentData=_useState18[0],setExperimentData=_useState18[1];var updateExperimentData=function updateExperimentData(newExpData){var updateditems=experimentData.map(function(item){if(item.exp_id===newExpData.exp_id){return{exp_id:item.exp_id,returns:newExpData.returns};}return item;});console.log(updateditems);setExperimentData(updateditems);};useEffect(function(){console.log(constants.SITE_IP);//GET OWN IP?\nvar sockUrl='ws://'+constants.SITE_IP+':8000/ws/expstate/';console.log(sockUrl);var updatesSocket=new WebSocket(sockUrl);updatesSocket.onopen=function(){console.log(\"socket is opened\");};// {\n// \"exp_id\": \"20230108_2253_BAC_algo_summary\",\n// \"returns\": {}\n// }\n// {\n//   \"exp_id\": \"20230108_2249_BAC_algo_summary\",\n//   \"returns\": {\n//       \"date\": [\n//           \"31-01-2011\",\n//           \"02-02-2011\",\n//           \"03-02-2011\"\n//       ],\n//       \"our_log_ret\": [\n//           0.02519607513651323,\n//           0.008541416232240806,\n//           0.009346907882019195\n//       ],\n//       \"BAC_log_ret\": [\n//           0.03927673713155808,\n//           -0.0028050509276083204,\n//           0.012561225872972695\n//       ]\n//   }\n// }\nupdatesSocket.onmessage=function(e){var data=JSON.parse(e.data)['data'];console.log(data);updateExperimentData(data);};updatesSocket.onclose=function(e){console.error('Chat socket closed unexpectedly');};},[]);var getAllBranches=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var requestOptions;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:requestOptions={method:'GET',redirect:'follow'};fetch(\"api/getbranches\",requestOptions).then(function(response){return response.text();}).then(function(result){return setAllBranches(JSON.parse(result)['ec2 data']);}).catch(function(error){return console.log('error',error);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function getAllBranches(_x){return _ref.apply(this,arguments);};}();function deploy(){return _deploy.apply(this,arguments);}function _deploy(){_deploy=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,requestOptions;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data={'op':'deploy','branch':formBranch,'alg':formAlg,'tickers':formTickers,'startDate':formStartDate,'endDate':formEndDate};requestOptions={method:'post',headers:{'Content-Type':'application/json'},body:JSON.stringify(data),redirect:'follow'};fetch(\"api/deploy\",requestOptions).then(function(response){return response.text();}).then(function(result){return setPastEvents(JSON.parse(result).data);}).catch(function(error){return console.log('error',error);});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _deploy.apply(this,arguments);};// async function getExperimentData(id) {\n//   var raw = JSON.stringify({\n//     \"op\": \"getexperimentdata\",\n//     \"id\": id\n//   });\n//   var requestOptions = {\n//     method: 'POST',\n//     headers: {\n//       'Content-Type': 'application/json',\n//     },\n//     body: raw,\n//     redirect: 'follow'\n//   };\n//   fetch(\"api/getExperimentData\", requestOptions)\n//     .then(response => response.text())\n//     .then(result => updateExperimentData(id, result))\n//     .catch(error => console.log('error', error));\n// }\nvar makeTable=function makeTable(array){var table=document.createElement('table');for(var i=0;i<array.length;i++){var row=document.createElement('tr');row.appendChild(array[i]);table.appendChild(row);}return table;};return/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"column\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Stock Selector\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"alg:\",/*#__PURE__*/_jsxs(\"select\",{name:\"alg\",id:\"alg\",form:\"alg\",onChange:function onChange(x){return setFormAlg(x.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-----\"}),/*#__PURE__*/_jsx(\"option\",{value:\"JAXSLAC\",children:\"JAXSLAC\"}),/*#__PURE__*/_jsx(\"option\",{value:\"AEJAXSAC\",children:\"AEJAXSAC\"}),/*#__PURE__*/_jsx(\"option\",{value:\"VAEJAXSAC\",children:\"VAEJAXSAC\"})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"label\",{children:[\"tickers:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formTickers,onChange:function onChange(e){return setFormTickers(e.target.value);}})]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(\"button\",{onClick:deploy,children:\"Submit Now\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"column\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"PAST EVENTS\"}),experimentData.map(function(element){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"p\",{children:element.exp_id}),/*#__PURE__*/_jsx(\"p\",{children:JSON.stringify(element.returns)})]})})});})]})]});}export default Console;","map":{"version":3,"names":["React","useState","useEffect","Component","constants","Console","allBranches","setAllBranches","message","setMessage","pastEvents","setPastEvents","formBranch","setFormBranch","formAlg","setFormAlg","formTickers","setFormTickers","formStartDate","setFormStartDate","formEndDate","setFormEndDate","experimentData","setExperimentData","updateExperimentData","newExpData","updateditems","map","item","exp_id","returns","console","log","SITE_IP","sockUrl","updatesSocket","WebSocket","onopen","onmessage","e","data","JSON","parse","onclose","error","getAllBranches","event","requestOptions","method","redirect","fetch","then","response","text","result","catch","deploy","headers","body","stringify","makeTable","array","table","document","createElement","i","length","row","appendChild","x","target","value","element"],"sources":["/home/ubuntu/Quantitative_Analysis_Site/frontend/src/components/console/console.js"],"sourcesContent":["import React, { useState, useEffect, Component } from \"react\";\n\nimport './console.css';\nimport * as constants from  '../constants.js'\n\nfunction Console() {\n\n  const [allBranches, setAllBranches] = useState([])\n  const [message, setMessage] = useState('');\n  const [pastEvents, setPastEvents] = useState([]);\n  const [formBranch, setFormBranch] = useState('');\n  const [formAlg, setFormAlg] = useState('');\n  const [formTickers, setFormTickers] = useState('');\n  const [formStartDate, setFormStartDate] = useState('');\n  const [formEndDate, setFormEndDate] = useState('');\n  const [experimentData, setExperimentData] = useState([])\n\n  const updateExperimentData = (newExpData) => {\n    const updateditems = experimentData.map((item) => {\n      if (item.exp_id === newExpData.exp_id) {\n        return { exp_id: item.exp_id, returns: newExpData.returns };\n      }\n      return item;\n    });\n    console.log(updateditems)\n    setExperimentData(updateditems);\n  };\n\n  useEffect(() => {\n    console.log(constants.SITE_IP)\n    //GET OWN IP?\n    const sockUrl = 'ws://' + constants.SITE_IP + ':8000/ws/expstate/';\n    console.log(sockUrl)\n    const updatesSocket = new WebSocket(sockUrl);\n    updatesSocket.onopen = () => {\n      console.log(\"socket is opened\")                             \n    }\n    // {\n    // \"exp_id\": \"20230108_2253_BAC_algo_summary\",\n    // \"returns\": {}\n    // }\n    \n    // {\n    //   \"exp_id\": \"20230108_2249_BAC_algo_summary\",\n    //   \"returns\": {\n    //       \"date\": [\n    //           \"31-01-2011\",\n    //           \"02-02-2011\",\n    //           \"03-02-2011\"\n    //       ],\n    //       \"our_log_ret\": [\n    //           0.02519607513651323,\n    //           0.008541416232240806,\n    //           0.009346907882019195\n    //       ],\n    //       \"BAC_log_ret\": [\n    //           0.03927673713155808,\n    //           -0.0028050509276083204,\n    //           0.012561225872972695\n    //       ]\n    //   }\n    // }\n    updatesSocket.onmessage = function(e) {\n        const data = JSON.parse(e.data)['data'];\n        console.log(data);\n        updateExperimentData(data)\n    }; \n    updatesSocket.onclose = function(e) {\n        console.error('Chat socket closed unexpectedly');\n    };\n  }, []);\n\n  const getAllBranches = async event => {\n    var requestOptions = {\n      method: 'GET',\n      redirect: 'follow'\n    };\n    fetch(\"api/getbranches\", requestOptions)\n      .then(response => response.text())\n      .then(result => setAllBranches(JSON.parse(result)['ec2 data']))\n      .catch(error => console.log('error', error))\n  }\n\n  async function deploy() {\n    var data = {\n      'op': 'deploy',\n      'branch': formBranch,\n      'alg': formAlg,\n      'tickers': formTickers,\n      'startDate': formStartDate,\n      'endDate': formEndDate,\n    }\n    var requestOptions = {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n      redirect: 'follow'\n    };\n    fetch(\"api/deploy\", requestOptions)\n      .then(response => response.text())\n      .then(result => setPastEvents(JSON.parse(result).data))\n      .catch(error => console.log('error', error))\n  };\n\n  // async function getExperimentData(id) {\n  //   var raw = JSON.stringify({\n  //     \"op\": \"getexperimentdata\",\n  //     \"id\": id\n  //   });\n  //   var requestOptions = {\n  //     method: 'POST',\n  //     headers: {\n  //       'Content-Type': 'application/json',\n  //     },\n  //     body: raw,\n  //     redirect: 'follow'\n  //   };\n    \n  //   fetch(\"api/getExperimentData\", requestOptions)\n  //     .then(response => response.text())\n  //     .then(result => updateExperimentData(id, result))\n  //     .catch(error => console.log('error', error));\n  // }\n\n  const makeTable = array => {\n    var table = document.createElement('table');\n    for (var i = 0; i < array.length; i++) {\n        var row = document.createElement('tr');\n        row.appendChild(array[i]);\n        table.appendChild(row);\n    }\n    return table;\n  }\n\n  return (\n    <div class=\"row\">\n      <div class=\"column\">\n        <h1>Stock Selector</h1>\n        <form>\n          <label>\n            alg:\n            <select name=\"alg\" id=\"alg\" form=\"alg\" onChange={x => setFormAlg(x.target.value)}>\n              <option value=\"\">-----</option>\n              <option value=\"JAXSLAC\">JAXSLAC</option>\n              <option value=\"AEJAXSAC\">AEJAXSAC</option>\n              <option value=\"VAEJAXSAC\">VAEJAXSAC</option>\n            </select>\n          </label>\n          <br/>\n          <label>\n            tickers:\n            <input \n              type=\"text\"\n              value={formTickers}\n              onChange={(e) => setFormTickers(e.target.value)}\n            />\n          </label>   \n          <br/>\n        </form>\n        <button onClick={deploy}>Submit Now</button>  \n      </div>\n        \n      <div class=\"column\">\n        <h1>PAST EVENTS</h1>\n        {experimentData.map(element => {\n          return (\n            <div>\n              <tr><td>\n                <p>{element.exp_id}</p> \n                <p>{JSON.stringify(element.returns)}</p>\n              </td></tr>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n    \n  );\n  \n}\n\nexport default Console;"],"mappings":"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"},"metadata":{},"sourceType":"module"}