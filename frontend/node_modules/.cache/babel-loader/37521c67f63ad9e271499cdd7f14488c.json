{"ast":null,"code":"import _regeneratorRuntime from\"/home/ubuntu/Quantitative_Analysis_Site/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/ubuntu/Quantitative_Analysis_Site/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/home/ubuntu/Quantitative_Analysis_Site/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/ubuntu/Quantitative_Analysis_Site/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,Component}from\"react\";import'./console.css';import*as constants from'../constants.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Console(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),allBranches=_useState2[0],setAllBranches=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),pastEvents=_useState6[0],setPastEvents=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),formBranch=_useState8[0],setFormBranch=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),formAlg=_useState10[0],setFormAlg=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),formTickers=_useState12[0],setFormTickers=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),formStartDate=_useState14[0],setFormStartDate=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),formEndDate=_useState16[0],setFormEndDate=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),experimentData=_useState18[0],setExperimentData=_useState18[1];useEffect(function(){var updateExperimentData=function updateExperimentData(newExpData){var found=false;var updateditems=experimentData.map(function(item){console.log(item.exp_id);console.log(newExpData.exp_id);if(item.exp_id===newExpData.exp_id){found=true;console.log(found);return{exp_id:item.exp_id,returns:newExpData.returns};}return item;});if(!found){console.log(newExpData);setExperimentData([].concat(_toConsumableArray(experimentData),[newExpData]));}else{setExperimentData(updateditems);}};var sockUrl='ws://'+constants.SITE_IP+':8000/ws/expstate/';var updatesSocket=new WebSocket(sockUrl);updatesSocket.onopen=function(){console.log(\"socket is opened\");};updatesSocket.onmessage=function(e){var data=JSON.parse(e.data)['data'];updateExperimentData(data);};updatesSocket.onclose=function(e){console.error('Chat socket closed unexpectedly');};},[experimentData,setExperimentData]);var getAllBranches=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var requestOptions;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:requestOptions={method:'GET',redirect:'follow'};fetch(\"api/getbranches\",requestOptions).then(function(response){return response.text();}).then(function(result){return setAllBranches(JSON.parse(result)['ec2 data']);}).catch(function(error){return console.log('error',error);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function getAllBranches(_x){return _ref.apply(this,arguments);};}();function deploy(){return _deploy.apply(this,arguments);}function _deploy(){_deploy=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,requestOptions;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data={'op':'deploy','branch':formBranch,'alg':formAlg,'tickers':formTickers,'startDate':formStartDate,'endDate':formEndDate};requestOptions={method:'post',headers:{'Content-Type':'application/json'},body:JSON.stringify(data),redirect:'follow'};fetch(\"api/deploy\",requestOptions).then(function(response){return response.text();}).then(function(result){return setPastEvents(JSON.parse(result).data);}).catch(function(error){return console.log('error',error);});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _deploy.apply(this,arguments);};// async function getExperimentData(id) {\n//   var raw = JSON.stringify({\n//     \"op\": \"getexperimentdata\",\n//     \"id\": id\n//   });\n//   var requestOptions = {\n//     method: 'POST',\n//     headers: {\n//       'Content-Type': 'application/json',\n//     },\n//     body: raw,\n//     redirect: 'follow'\n//   };\n//   fetch(\"api/getExperimentData\", requestOptions)\n//     .then(response => response.text())\n//     .then(result => updateExperimentData(id, result))\n//     .catch(error => console.log('error', error));\n// }\nvar makeTable=function makeTable(array){var table=document.createElement('table');for(var i=0;i<array.length;i++){var row=document.createElement('tr');row.appendChild(array[i]);table.appendChild(row);}return table;};console.log(experimentData);return/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"column\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Stock Selector\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"alg:\",/*#__PURE__*/_jsxs(\"select\",{name:\"alg\",id:\"alg\",form:\"alg\",onChange:function onChange(x){return setFormAlg(x.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-----\"}),/*#__PURE__*/_jsx(\"option\",{value:\"JAXSLAC\",children:\"JAXSLAC\"}),/*#__PURE__*/_jsx(\"option\",{value:\"AEJAXSAC\",children:\"AEJAXSAC\"}),/*#__PURE__*/_jsx(\"option\",{value:\"VAEJAXSAC\",children:\"VAEJAXSAC\"})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"label\",{children:[\"tickers:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formTickers,onChange:function onChange(e){return setFormTickers(e.target.value);}})]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(\"button\",{onClick:deploy,children:\"Submit Now\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"column\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"PAST EVENTS\"}),experimentData.map(function(element){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"p\",{children:element.exp_id}),/*#__PURE__*/_jsx(\"p\",{children:JSON.stringify(element.returns)})]})})});})]})]});}export default Console;","map":{"version":3,"names":["React","useState","useEffect","Component","constants","Console","allBranches","setAllBranches","message","setMessage","pastEvents","setPastEvents","formBranch","setFormBranch","formAlg","setFormAlg","formTickers","setFormTickers","formStartDate","setFormStartDate","formEndDate","setFormEndDate","experimentData","setExperimentData","updateExperimentData","newExpData","found","updateditems","map","item","console","log","exp_id","returns","sockUrl","SITE_IP","updatesSocket","WebSocket","onopen","onmessage","e","data","JSON","parse","onclose","error","getAllBranches","event","requestOptions","method","redirect","fetch","then","response","text","result","catch","deploy","headers","body","stringify","makeTable","array","table","document","createElement","i","length","row","appendChild","x","target","value","element"],"sources":["/home/ubuntu/Quantitative_Analysis_Site/frontend/src/components/console/console.js"],"sourcesContent":["import React, { useState, useEffect, Component } from \"react\";\n\nimport './console.css';\nimport * as constants from  '../constants.js'\n\nfunction Console() {\n\n  const [allBranches, setAllBranches] = useState([])\n  const [message, setMessage] = useState('');\n  const [pastEvents, setPastEvents] = useState([]);\n  const [formBranch, setFormBranch] = useState('');\n  const [formAlg, setFormAlg] = useState('');\n  const [formTickers, setFormTickers] = useState('');\n  const [formStartDate, setFormStartDate] = useState('');\n  const [formEndDate, setFormEndDate] = useState('');\n  const [experimentData, setExperimentData] = useState([])\n\n  useEffect(() => {\n\n    const updateExperimentData = (newExpData) => {\n      var found = false\n      const updateditems = experimentData.map((item) => {\n        console.log(item.exp_id)\n        console.log(newExpData.exp_id)\n        if (item.exp_id === newExpData.exp_id) {\n          found = true\n          console.log(found)\n          return { exp_id: item.exp_id, returns: newExpData.returns };\n        }\n        return item;\n      });\n      if (!found) {\n        console.log(newExpData)\n        setExperimentData([...experimentData, newExpData])\n      }\n      else {\n        setExperimentData(updateditems);\n      }\n    };\n\n    const sockUrl = 'ws://' + constants.SITE_IP + ':8000/ws/expstate/';\n    const updatesSocket = new WebSocket(sockUrl);\n    updatesSocket.onopen = () => {\n      console.log(\"socket is opened\")                            \n    }\n    updatesSocket.onmessage = function(e) {\n        const data = JSON.parse(e.data)['data'];\n        updateExperimentData(data)\n    }; \n    updatesSocket.onclose = function(e) {\n        console.error('Chat socket closed unexpectedly');\n    };\n  }, [experimentData, setExperimentData]);\n\n  const getAllBranches = async event => {\n    var requestOptions = {\n      method: 'GET',\n      redirect: 'follow'\n    };\n    fetch(\"api/getbranches\", requestOptions)\n      .then(response => response.text())\n      .then(result => setAllBranches(JSON.parse(result)['ec2 data']))\n      .catch(error => console.log('error', error))\n  }\n\n  async function deploy() {\n    var data = {\n      'op': 'deploy',\n      'branch': formBranch,\n      'alg': formAlg,\n      'tickers': formTickers,\n      'startDate': formStartDate,\n      'endDate': formEndDate,\n    }\n    var requestOptions = {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n      redirect: 'follow'\n    };\n    fetch(\"api/deploy\", requestOptions)\n      .then(response => response.text())\n      .then(result => setPastEvents(JSON.parse(result).data))\n      .catch(error => console.log('error', error))\n  };\n\n  // async function getExperimentData(id) {\n  //   var raw = JSON.stringify({\n  //     \"op\": \"getexperimentdata\",\n  //     \"id\": id\n  //   });\n  //   var requestOptions = {\n  //     method: 'POST',\n  //     headers: {\n  //       'Content-Type': 'application/json',\n  //     },\n  //     body: raw,\n  //     redirect: 'follow'\n  //   };\n    \n  //   fetch(\"api/getExperimentData\", requestOptions)\n  //     .then(response => response.text())\n  //     .then(result => updateExperimentData(id, result))\n  //     .catch(error => console.log('error', error));\n  // }\n\n  const makeTable = array => {\n    var table = document.createElement('table');\n    for (var i = 0; i < array.length; i++) {\n        var row = document.createElement('tr');\n        row.appendChild(array[i]);\n        table.appendChild(row);\n    }\n    return table;\n  }\n  console.log(experimentData)\n  return (\n    <div class=\"row\">\n      <div class=\"column\">\n        <h1>Stock Selector</h1>\n        <form>\n          <label>\n            alg:\n            <select name=\"alg\" id=\"alg\" form=\"alg\" onChange={x => setFormAlg(x.target.value)}>\n              <option value=\"\">-----</option>\n              <option value=\"JAXSLAC\">JAXSLAC</option>\n              <option value=\"AEJAXSAC\">AEJAXSAC</option>\n              <option value=\"VAEJAXSAC\">VAEJAXSAC</option>\n            </select>\n          </label>\n          <br/>\n          <label>\n            tickers:\n            <input \n              type=\"text\"\n              value={formTickers}\n              onChange={(e) => setFormTickers(e.target.value)}\n            />\n          </label>   \n          <br/>\n        </form>\n        <button onClick={deploy}>Submit Now</button>  \n      </div>\n        \n      <div class=\"column\">\n        <h1>PAST EVENTS</h1>\n        {experimentData.map(element => {\n          return (\n            <div>\n              <tr><td>\n                <p>{element.exp_id}</p> \n                <p>{JSON.stringify(element.returns)}</p>\n              </td></tr>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n    \n  );\n  \n}\n\nexport default Console;"],"mappings":"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"},"metadata":{},"sourceType":"module"}